https://blog.csdn.net/qq_41470339/article/details/80052986



### 总结



有的时候我习惯使用很简短的，自己的话总结一篇文章，可能语言功底很深厚的人会认为这样的总结会太肤浅，这里虽然也包含着我的语言能力不好的问题，另一个问题是，过多的重复别人的话，会让我产生思想被他人束缚，强迫死记硬背的心理感受。



### 要点：

主动思考、及时总结、制定规划等。做到专注。

对编码保持热情，保持好奇心，乐于探求事物本质



===============



http://www.cnblogs.com/ToDoToTry/archive/2009/06/21/1507760.html

读别人的代码

有几种方式



### 1 先了解系统架构与行为模式，再细读

1.从起点开始，循序读完所有代码（细读）

非常费时间，而且像Linux 内核这样的代码，千万行级别的，是不可能的，新加入的代码数量超过你看代码学习的速度（如果一行行看的话）

A。费时

B。不容易了解全貌



2.根据系统的主要架构来，先了解主干，脉络，然后才是枝叶，探索式的摸索到框架脉络（粗读）

A。粗读掌握框架

B。遇到详细的问题再去细读实现



**熟悉沟通语言与惯例用语** 

1.程序语言

2.命名规则（匈牙利，驼峰）



### 2 摸清架构，便可轻松掌握全貌

在本文中，我们的重点放在：要了解一个系统，最好是采取由上至下的方式。先试着捕捉系统架构性的观念，不要过早钻进细节，因为那通常对于你了解全貌，没有多大的帮助。阅读程式码不需要从第一行读起，**我们的目的并不是在于读遍`每一段`程式码。**

**阅读程式码的目的在于了解系统的`全貌`**

**由上而下厘清架构后，便可轻易理解组成关系**



**了解架构，必须要加上层次感**

java的J2EE



Struts Hibernate

Servlet

J2EE



Android APP

Android

计算机硬件

世界



相较于直接切入最细微的单一角色行为，不如了解某个特定的架构中，究竟存在**多少角色**，以及这些**角色之间的互动模式**，比较能够帮助我们了解整个系统的运作方式。 

Linux内核而言

角色（模块）：硬件平台架构兼容模块，虚拟文件系统，进程管理，内存管理，驱动管理-网络堆栈，系统调用

7个主要模块



**探索架构的第一件事：找出系统如何初始化**

一，系统如何**初始化**，

二，与这个系统相接的其他系统（或使用者）有那些，而**相接的介面(接口协议)**又是什么;

三，系统如何反应各种事件(正常流程,最精简的)

四，系统如何处理各种异常及错误。（异常情况）



之所以要了解与系统相接的其他系统（或使用者） ，为的是要界定出***系统的边界***。

其他的系统可能会提供输入给我们所探索的系统，也可能接收来自这系统的输出，了解这边界所在，才能确定系统的外观

**这是我的一个问题所在，常常看代码看的过于深入，忘记了边界，往往就开始变得晕头转向，甚至忘了为什么会看到这里，从哪里跟来的，不得要领**



### -3 优质工具在手，读懂程式非难事（配合IDE)

最常见的事情是：首先确定了一个函数，然后跟踪该函数中所被调用的函数。为了找到被调用的函数源码，往往会跨文件，夸模块，为了快速的定位，可以使用IDE提供的查找功能，或者linux的`grep`命令，搜索文件内容匹配字符串。但是往往也会有多个相匹配的结果，造成定位不精确的问题，那么这个问题如何解决呢？有些IDE如Source Insight 可以扫描整个项目的符号，并做关联，可以提供相对精确的定位功能，另外如果条件允许，可以将想要查看的程序编译出来，并打开调试模式，在调用该子函数之前，打下断点，随后跟踪断点进入函数，让调试器和运行时来告诉我们，这个子函数的相关信息，因为往往除了你是程序作者外（你最了解自己写程序的初衷，和目的），另外一个对程序了如指掌的就是进行运行时计算的计算机本身了。

也可以使用`gtags`工具

找**入口**函数

归纳总结常见架构及设计**模式**

变量和函数名的**自文档性**

跟踪函数调用的时候，或者类与类的关系时，**应该一边阅读，一边记录文件**。因为人的记忆力通常有限，对于陌生的事物更是**容易遗忘**，因此边阅读边记录，是很好的辅助。

从系统的分析及设计**文档**着手，便是快速了解系统运作情境的一个途径

有时候因为作者没有将几个子函数或者语句打包进一个子函数，可能会造成阅读者理解的不便，**因为`好几行`程式，才构成`一个`具有独立抽象意义的子动作**。这是需要读者自己能够将看似分离无关的几句代码，能够总结出一个具有抽象意义的动作



**无法望文生义的函式，先试着预看一层** 

*我存在的一个问题是，生怕错过了一些重要的东西，就算看起来再生涩，也硬着头皮看很多，其实得不偿失*



根据兴趣点（目的），来决定，展开的层数。也就是所越与目标贴近的，我们就越应该展开深入几层，要带着问题（明确目的，明确的目标）去看代码

***适度地`忽略`***不需要了解的细节，是一个很能力（有一种很重要的能力，可以在眼花缭乱的景象中，可以很快的看出主要的脉络，不被繁杂的枝叶所左右，否则又会坠入源码无限细节的深渊）

在多人开发的模式下，越是好的软体专案，越看不出某程式码片段究竟是由谁所写下的。 



为了更好理解源码，可以假设自己就是作者，站在作者的角度思考，为什么需要这个函数，这个变量，用意是什么。







#### 总结

- 探索架构要先找到**全局入口**，如c程序，就是找main函数，汇编就找 _start，计算机硬件，就找CPU上电后，第一句运行代码的地址，so文件就是 init_array 或者 全局可见的 函数
- 命名规则
- 惯用语
- 编写者的习惯
- 先了解**全貌**，而非所有细节,不要过早钻进细节，先弄清架构和脉络，主要角色（模块），以及协议，会比较好，否则容易迷失在茫茫无尽的源码海洋里，脉络和架构，就好比地图和指南针，当你进入一片丛林的时候，能帮助你找到宝藏的，能让你全身而退的，就是地图和指南针
- 对于架构中的角色要有认识
- 架构与子架构之间要有层次感
- 根据目标（或者需要了解的细粒度）来决定是否深入展开并细读
- 对于一眼看不懂的函数，暂时只看一层，不用太深（因为很有可能会引导你看过多的细节，而导致本应去掌握全貌结果走偏了）